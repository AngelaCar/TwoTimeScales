<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualize hazards with two time scales • TwoTimeScales</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualize hazards with two time scales">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TwoTimeScales</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Homepage"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AngelaCar/TwoTimeScales"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualize hazards with two time scales</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AngelaCar/TwoTimeScales/blob/main/vignettes/visualization.Rmd" class="external-link"><code>vignettes/visualization.Rmd</code></a></small>
      <div class="d-none name"><code>visualization.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AngelaCar/TwoTimeScales" class="external-link">TwoTimeScales</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The topic of this vignette is visualization of the hazard of one
event over two time scales. We show the complete set of options for the
method <code>plot</code>, implemented for object of class
<code>'haz2ts'</code> and <code>'haz2tsLMM'</code>. We assume that the
reader already knows how to estimate the smooth hazard model with two
time scales. Therefore, here we will only discuss the plotting function.
For illustration, we will use the basic model from the vignette
<em>Smooth hazards with two time scales</em>.</p>
</div>
<div class="section level2">
<h2 id="the-function-plot">The function <code>plot()</code><a class="anchor" aria-label="anchor" href="#the-function-plot"></a>
</h2>
<p>The method <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, for the class <code>'haz2ts</code>
offers different possibilities to plot the results of the model with two
time scales. The user can choose between plotting the hazard surface
<code>which_plot == "hazard"</code>, plotting the standard error surface
<code>which_plot == "SE"</code>, plotting cross-sections (also called
“slices”) of the surface at specific values of one of the two time
dimensions <code>which_plot == "slices"</code>, and finally, for a model
with covariates’ effects, it is possible to plot only the estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
coefficients with their confidence intervals (or on the hazard ratios
scale) with <code>which_plot == "covariates"</code>.</p>
<p>We will now examine each of these options and their use.</p>
<div class="section level3">
<h3 id="baseline-hazard-and-log-hazard">Baseline hazard and log-hazard<a class="anchor" aria-label="anchor" href="#baseline-hazard-and-log-hazard"></a>
</h3>
<p>The default plot is the hazard surface over the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(u,s)</annotation></semantics></math>-plane,
with contour lines in white to mark levels of the hazard. It is obtained
by passing the fitted object, obtained from <code><a href="../reference/fit2ts.html">fit2ts()</a></code> (hence
of class <code>'haz2ts'</code>, or <code>'haz2tsLMM'</code>) to the
function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/basehaz-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="section level4">
<h4 id="plot-on-the-ts-plane">Plot on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(t,s)</annotation></semantics></math>-plane<a class="anchor" aria-label="anchor" href="#plot-on-the-ts-plane"></a>
</h4>
<p>The same plot can be obtained over the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(t,s)</annotation></semantics></math>-plan
using a rectangular grid or a grid of parallelograms (in which case it
is not possible to plot contour lines). This is done by modifying the
arguments <code>original</code> and <code>rectangular_grid</code> in the
list of options for the plotting parameters in
<code>plot_options</code>. Additionally, we will here customize the
title of the plots and the label of the axes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>    font.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       rectangular_grid <span class="op">=</span> <span class="cn">T</span>,               <span class="co"># for grid of rectangles</span></span>
<span>       original <span class="op">=</span> <span class="cn">T</span>,                       <span class="co"># for plot in (t,s)-plane</span></span>
<span>       main <span class="op">=</span> <span class="st">"Original plane - rectangular grid"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       rectangular_grid <span class="op">=</span> <span class="cn">F</span>,                <span class="co"># for grid of parallelograms</span></span>
<span>       original <span class="op">=</span> <span class="cn">T</span>,                        <span class="co"># for plot in (t,s)-plane</span></span>
<span>       main <span class="op">=</span> <span class="st">"Original plane - grid of parallelograms"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/original-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="evaluate-the-b-splines-on-a-finer-grid">Evaluate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>-splines
on a finer grid<a class="anchor" aria-label="anchor" href="#evaluate-the-b-splines-on-a-finer-grid"></a>
</h4>
<p>With the default options, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>-splines
bases used for estimation will be also used to compute the values of the
hazard. If the grid of bins used for binning the data, and to evaluate
the estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>-splines
bases, is already dense (many small bins), the plot of the estimated
hazard will appear nicely smooth. However, in some cases, larger bins
are used for the original binning of the data and for the estimation of
the model. In such cases it may be worthwhile to evaluate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>-splines
bases on a finer grid of points. The hazard surface will appear much
smoother because it will be interpolated over more points. It is
possible to change the grid for plotting by passing the specification
for a new grid to the argument <code>plot_grid</code>. We show how to do
so by passing the specification for a grid where the bins are 10 days
apart from each other (as opposed to 30). In this case it is a good idea
to increase the number of shades in the color legend too.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>umin <span class="op">=</span> <span class="fl">0</span>, umax <span class="op">=</span> <span class="fl">2300</span>, du <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>smin <span class="op">=</span> <span class="fl">0</span>, smax <span class="op">=</span> <span class="fl">2730</span>, du <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_shades <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"Denser plotting grid"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/new-grid-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-the-log-hazard">Plot the log-hazard<a class="anchor" aria-label="anchor" href="#plot-the-log-hazard"></a>
</h4>
<p>We can plot the hazard on the log-scale by changing the argument
<code>loghazard = T</code> in <code>plot_options</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>    font.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       loghazard <span class="op">=</span> <span class="cn">T</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Log-hazard (u,s)"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       original <span class="op">=</span> <span class="cn">T</span>,</span>
<span>       loghazard <span class="op">=</span> <span class="cn">T</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Log-hazard (t,s)"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/loghaz-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-the-log10-hazard">Plot the log10-hazard<a class="anchor" aria-label="anchor" href="#plot-the-log10-hazard"></a>
</h4>
<p>Similarly, we can plot the hazard on the log10-scale by changing the
argument <code>log10hazard = T</code> in <code>plot_options</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>    font.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       log10hazard <span class="op">=</span> <span class="cn">T</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Log10-hazard (u,s)"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       original <span class="op">=</span> <span class="cn">T</span>,</span>
<span>       log10hazard <span class="op">=</span> <span class="cn">T</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Log10-hazard (t,s)"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/log10haz-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cut-extrapolated-hazard">Cut extrapolated hazard<a class="anchor" aria-label="anchor" href="#cut-extrapolated-hazard"></a>
</h4>
<p><span class="citation">Carollo et al. (2024)</span> discusses the
issue of extrapolated hazard beyond the maximum value observed for the
time scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
We can limit the plot of the hazard to those areas where it is not
extrapolated. We do so by changing the values of
<code>cut_extrapolated = T</code> and <code>tmax</code> in
<code>plot_options</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>    font.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cut_extrapolated <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                         tmax <span class="op">=</span> <span class="fl">3214</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"Cut extrapolated hazard"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cut_extrapolated <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                         tmax <span class="op">=</span> <span class="fl">3214</span>,</span>
<span>                         original <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"Cut extrapolated hazard"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/cut-extra-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="change-color-palette-and-color-of-the-contour-lines">Change color palette and color of the contour lines<a class="anchor" aria-label="anchor" href="#change-color-palette-and-color-of-the-contour-lines"></a>
</h4>
<p>Let us try a new color palette and modify the options concerning the
contour lines. The palette should be a function of the number of shades,
so we need to code one extra line…</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mycol</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nshades</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/hcl_palettes.html" class="external-link">sequential_hcl</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nshades</span>, <span class="st">"Blues 3"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col_palette <span class="op">=</span> <span class="va">mycol</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"New colors"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span>,</span>
<span>                         contour_col <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>                         contour_nlev <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/colors-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="standard-errors-surface">Standard Errors surface<a class="anchor" aria-label="anchor" href="#standard-errors-surface"></a>
</h3>
<p>The same options apply for the SE surface, so we will just show how
to produce the simplest version of the SE surface plot.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Standard Errors of the hazard"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/SE-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       loghazard <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Standard Errors of the log-hazard"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/SE-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       log10hazard <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Standard Errors of the log10-hazard"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/SE-3.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="cross-sections-of-the-hazard">Cross-sections of the hazard<a class="anchor" aria-label="anchor" href="#cross-sections-of-the-hazard"></a>
</h3>
<p>Another very informative representation for the 2d hazard consists of
plotting ‘slices’ (or cross-sections) of the two-dimensional hazard as
curves over one of the time scales. For example, the 2d hazard surface
is plotted as a series of one-dimensional hazard curves over time since
recurrence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
for selected values of time at recurrence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>.
Note: Adding an automated legend to this kind of plot is still not
implemented in the package yet, but we can add one manually.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"slices"</span>,</span>
<span>     where_slices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>     direction <span class="op">=</span> <span class="st">"u"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Slices of the hazard"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time since recurrence"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Hazard"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/slices-u-1.png" width="576" style="display: block; margin: auto;"></p>
<p>It is also possible to plot one-dimensional hazards over time since
randomization
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>)
for selected values of time since recurrence
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>).
The interpretation of these one-dimensional hazards is less clear at the
individual level, but is meaningful at the population level. To obtain
such plot, we specify <code>direction = "s"</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"slices"</span>,</span>
<span>     where_slices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>     direction <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Slices of the hazard"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Hazard"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>, </span>
<span>       lty<span class="op">=</span><span class="fl">1</span>, </span>
<span>       col<span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/slices-s-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="survival-function">Survival function<a class="anchor" aria-label="anchor" href="#survival-function"></a>
</h3>
<p>We can represent the survival function as a two-dimensional surface
over the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(u,s)</annotation></semantics></math>-plane
(or the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(t,s)</annotation></semantics></math>-plane),
or as cross-sectional one-dimensional curves over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
for selected values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mycol2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nshades</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/hcl_palettes.html" class="external-link">sequential_hcl</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nshades</span>, <span class="st">"PurpOr"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col_palette <span class="op">=</span> <span class="va">mycol2</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"Survival function"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span>,</span>
<span>                        contour_nlev <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/survival-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>     where_slices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>     direction <span class="op">=</span> <span class="st">"u"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                         surv_slices <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"Slices of the survival function"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Survival"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3000</span>, y <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>       xpd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Time of\n recurrence"</span>,</span>
<span>       col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/survival-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="cumulative-hazard">Cumulative hazard<a class="anchor" aria-label="anchor" href="#cumulative-hazard"></a>
</h3>
<p>Similarly, we can plot the cumulative hazard either as a surface or
as one-dimensional curves over <code>s</code> for selected values of
<code>u</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mycol3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nshades</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/hcl_palettes.html" class="external-link">sequential_hcl</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nshades</span>, <span class="st">"BluGrn"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"cumhaz"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col_palette <span class="op">=</span> <span class="va">mycol3</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"Cumulative hazard"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time at recurrence"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Time since recurrence"</span>,</span>
<span>                         contour_nlev <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/cumhaz-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,</span>
<span>     which_plot <span class="op">=</span> <span class="st">"cumhaz"</span>,</span>
<span>     where_slices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>     direction <span class="op">=</span> <span class="st">"u"</span>,</span>
<span>     plot_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                         cumhaz_slices <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         main <span class="op">=</span> <span class="st">"Slices of the cumulative hazard"</span>,</span>
<span>                         xlab <span class="op">=</span> <span class="st">"Time since randomization"</span>,</span>
<span>                         ylab <span class="op">=</span> <span class="st">"Cumulative hazard"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3000</span>, y <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>       xpd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">365</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Time of\n recurrence"</span>,</span>
<span>       col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/cumhaz-2.png" width="672" style="display: block; margin: auto;"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Carollo:2024" class="csl-entry">
Carollo, Angela, Paul H. C. Eilers, Hein Putter, and Jutta Gampe. 2024.
<span>“Smooth Hazards with Multiple Time Scales.”</span> <em>Statistics
in Medicine</em>. <a href="https://doi.org/10.1002/sim.10297" class="external-link">https://doi.org/10.1002/sim.10297</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Angela Carollo, Paul H.C. Eilers, Jutta Gampe.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
