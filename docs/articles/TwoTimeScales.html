<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="TwoTimeScales">
<title>Introduction to TwoTimeScales • TwoTimeScales</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to TwoTimeScales">
<meta property="og:description" content="TwoTimeScales">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TwoTimeScales</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AngelaCar/TwoTimeScales">
    <span class="fa fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to TwoTimeScales</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AngelaCar/TwoTimeScales/blob/HEAD/vignettes/TwoTimeScales.Rmd" class="external-link"><code>vignettes/TwoTimeScales.Rmd</code></a></small>
      <div class="d-none name"><code>TwoTimeScales.Rmd</code></div>
    </div>

    
    
<p>Disclaimer: the current version of the package and of this vignette
is a work-in-progress! Details might change with future updates and this
vignette will be updated consequently.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AngelaCar/TwoTimeScales" class="external-link">TwoTimeScales</a></span><span class="op">)</span></span></code></pre></div>
<p>Time-to-event data can involve more than one time scale. In such
cases, the hazard of one event can be expressed as a function of two
time dimensions. The two time scales act jointly to determine the hazard
levels.</p>
<p>The <code>TwoTimeScales</code> package allows the user to estimate
and visualize the hazard of one event as a smooth function of two time
dimensions (the two time scales). Additionally, it provides functions to
estimate and visualize a smooth hazard with one time scale.</p>
<p>Estimation is performed using <span class="math inline">\(P\)</span>-splines (univariate or bivariate) and
Poisson regression.</p>
<p>When working with time-to-event data with multiple time scales, there
are three main steps involved:</p>
<ul>
<li>data wrangling and preparation</li>
<li>estimation of the smooth hazard model</li>
<li>visualization of the results</li>
</ul>
<p>This document introduces the main tools in the package
<code>TwoTimeScales</code> and demonstrates how to apply them to smooth
hazards with one or two time scales. This vignette serves as an
introduction to the package, and it is therefore a good place to start
for new users of the package. We also provide three additional, more
specialized vignettes.</p>
<div class="section level3">
<h3 id="data-reccolon2ts">Data: reccolon2ts<a class="anchor" aria-label="anchor" href="#data-reccolon2ts"></a>
</h3>
<p>We use data from a clinical trial on colon cancer and the effects of
two adjuvant therapies after colon resection <span class="citation">(Laurie et al. 1989; Moertel et al. 1995)</span>. The
original data are included in the R-package <code>survival</code> <span class="citation">(Therneau 2020)</span>, see
<code>help(survival::colon)</code>. Patients were followed, after
resection of the colon, from randomization into one of the two treatment
groups or the control group (no treatment), to death or end of the
study. The two treatments were either Levamisole, a drug showing
immunostimulatory activity, or a combination of Levamisole and
Fluorouracil, a moderately toxic chemotherapy agent.</p>
<p>The dataset <code>colon</code> contains 929 individuals, and 468
(50.4%) experienced a recurrence of the cancer during follow-up period.
However, seven patients with recurrence left the risk set at the
recorded time of recurrence, leaving 461 who were followed up further.
In the dataset <code>reccolon2ts</code> we include these 461
individuals. A description of the data and the variables can be accessed
through <code><a href="../reference/reccolon2ts.html">help(reccolon2ts)</a></code>.</p>
<p>There are two time scales in the <code>reccolon2ts</code> data: The
time from randomization to death or censoring, measured in days since
randomization <code>reccolon2ts$timedc</code> and the time since
recurrence of the cancer <code>reccolon2ts$timesr</code>, also measured
in days. Additionally, we consider another variable, measuring the time
from randomization to recurrence <code>reccolon2ts$timer</code>. The
latter is not a time scale, but a fixed time covariate which varies
among individuals in the data.</p>
<p>In the original dataset, each individual enters the risk set after
recurrence at the exact time of the recurrence. Therefore, individual’s
observations are not left truncated. However, to show how the model can
easily incorporate left truncation, we introduced some artificial left
truncated entry times for 40 individuals in the dataset,
<code>reccolon2ts$entrys</code> (on the time since recurrence scale),
and <code>reccolon2ts$entryt</code> (on the time since randomization
scale).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">reccolon2ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    461 obs. of  25 variables:</span></span>
<span><span class="co">#&gt;  $ id      : num  1 3 4 5 6 7 13 14 16 17 ...</span></span>
<span><span class="co">#&gt;  $ study   : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ rx      : Factor w/ 3 levels "Obs","Lev","Lev+5FU": 3 1 3 1 3 2 1 2 1 2 ...</span></span>
<span><span class="co">#&gt;  $ sex     : Factor w/ 2 levels "female","male": 2 1 1 2 1 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ age     : num  43 71 66 69 57 77 64 68 68 62 ...</span></span>
<span><span class="co">#&gt;  $ obstruct: num  0 0 1 0 0 0 0 1 0 1 ...</span></span>
<span><span class="co">#&gt;  $ perfor  : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ adhere  : num  0 1 0 0 0 0 0 0 0 1 ...</span></span>
<span><span class="co">#&gt;  $ nodes   : num  5 7 6 22 9 5 1 3 1 6 ...</span></span>
<span><span class="co">#&gt;  $ status  : num  1 1 1 1 1 1 1 1 0 1 ...</span></span>
<span><span class="co">#&gt;  $ differ  : Factor w/ 3 levels "well","moderate",..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ extent  : Factor w/ 4 levels "submucosa","muscle",..: 3 2 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">#&gt;  $ surg    : Factor w/ 2 levels "short","long": 1 1 2 2 1 2 1 1 2 1 ...</span></span>
<span><span class="co">#&gt;  $ node4   : num  1 1 1 1 1 1 0 0 0 1 ...</span></span>
<span><span class="co">#&gt;  $ timedc  : num  1521 963 293 659 1767 ...</span></span>
<span><span class="co">#&gt;  $ etype   : num  2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ timer   : num  968 542 245 523 904 ...</span></span>
<span><span class="co">#&gt;  $ entrys  : num  0 0 0 0 0 0 0 0 0 88 ...</span></span>
<span><span class="co">#&gt;  $ timesr  : num  553 421 48 136 863 ...</span></span>
<span><span class="co">#&gt;  $ entryt  : num  968 542 245 523 904 ...</span></span>
<span><span class="co">#&gt;  $ timedc_y: num  4.164 2.637 0.802 1.804 4.838 ...</span></span>
<span><span class="co">#&gt;  $ timesr_y: num  1.514 1.153 0.131 0.372 2.363 ...</span></span>
<span><span class="co">#&gt;  $ entrys_y: num  0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ entryt_y: num  2.65 1.484 0.671 1.432 2.475 ...</span></span>
<span><span class="co">#&gt;  $ timer_y : num  2.65 1.484 0.671 1.432 2.475 ...</span></span></code></pre></div>
<p>Before we illustrate how to work with the package, a clarification
about notation is needed. In our two time scales model notation, we
indicate the two time scales with <span class="math inline">\(t\)</span>
and <span class="math inline">\(s\)</span>, and the fixed time at entry
in the process is indicated with <span class="math inline">\(u\)</span>.
Whenever we refer to models with one time scale only, we mostly consider
this to be the time scale indicated by <span class="math inline">\(s\)</span> (as opposed to the most common used
notation <span class="math inline">\(t\)</span>). Therefore, in all the
functions that require the individual times as inputs, the only required
inputs will be indicated with <span class="math inline">\(s\)</span>
(rather than <span class="math inline">\(t\)</span>).</p>
</div>
<div class="section level3">
<h3 id="step-1-data-preparation">Step 1: data preparation<a class="anchor" aria-label="anchor" href="#step-1-data-preparation"></a>
</h3>
<p>Time-to-event data come in the form of a time variable, indicated
with <span class="math inline">\(s\)</span>, where <span class="math inline">\(s \ge 0\)</span> and a variable which contains the
event’s indicator. In the simplest time-to-event models, there is only
one type of event, so that this event’s indicator can only assume values
0 and 1.</p>
<p>To apply the <span class="math inline">\(P\)</span>-splines model for
the hazard we need to bin the individual data into aggregated vectors of
exposure times and events’ indicators. Therefore, the first step of the
analysis, will be data preparation. This step involves the construction
of the bins and the actual binning of the data. Both steps are
implemented and performed by the function <code><a href="../reference/prepare_data.html">prepare_data()</a></code>,
which requires as inputs the individual data vectors, and the desired
specification for the bins. This function works in the same way for the
case of data with one time scale only, and for data over two time
scales. The only difference is in the inputs required in each of the
cases. We will now illustrate its use in both cases.</p>
<div class="section level4">
<h4 id="one-time-scale-only">One time scale only<a class="anchor" aria-label="anchor" href="#one-time-scale-only"></a>
</h4>
<p>For data over one time scale, the function requires as minimal inputs
only a vector of exit times (<code>s_out</code>), a vector of events’
indicators (<code>events</code>) and the desired bins’ size
(<code>ds</code>). If the data are left truncated, the entry times can
be passed to the argument <code>s_in</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt1ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_data</a></span><span class="op">(</span>s_in <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">entrys</span>,</span>
<span>                      s_out <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">timesr</span>,</span>
<span>                      events <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">status</span>,</span>
<span>                      ds <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dt1ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ bins   :List of 3</span></span>
<span><span class="co">#&gt;   ..$ bins_s: num [1:92] 0 30 60 90 120 150 180 210 240 270 ...</span></span>
<span><span class="co">#&gt;   ..$ mids  : num [1:91] 15 45 75 105 135 165 195 225 255 285 ...</span></span>
<span><span class="co">#&gt;   ..$ ns    : int 91</span></span>
<span><span class="co">#&gt;  $ bindata:List of 2</span></span>
<span><span class="co">#&gt;   ..$ r: num [1:91] 12613 12322 11793 11399 10969 ...</span></span>
<span><span class="co">#&gt;   ..$ y: num [1:91] 14 24 16 11 24 22 20 10 24 26 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "data2ts"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dt1ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class 'data2ts'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data:</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ bins   :List of 3</span></span>
<span><span class="co">#&gt;  $ bindata:List of 2</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "data2ts"</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Range covered by the bins: </span></span>
<span><span class="co">#&gt; $bins_s</span></span>
<span><span class="co">#&gt; [1]    0 2730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of bins: </span></span>
<span><span class="co">#&gt; $ns</span></span>
<span><span class="co">#&gt; [1] 91</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overview of the binned data:</span></span>
<span><span class="co">#&gt; [1] "Total exposure time: 236006"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "Total number of events: 409"</span></span></code></pre></div>
<p>The object <code>dt1ts</code> is a list with two elements. The first
element is a list of bins (<code>bins_s</code>) with their midpoints
(<code>mids</code>) and the number of bins (<code>ns</code>). The second
element of the list is another list with the data binned, a vector of
exposures called <code>r</code> and a vector of events’ counts
<code>y</code>. By calling the method <code>print(dt1ts)</code>, we
obtain additional information about the data, such as the range covered
by the bins, the total exposure time and the total number of events.</p>
</div>
<div class="section level4">
<h4 id="two-time-scales">Two time scales<a class="anchor" aria-label="anchor" href="#two-time-scales"></a>
</h4>
<p>The same function is used to bin the individual data in a
two-dimensional grid of rectangles (or squares) over <span class="math inline">\(u\)</span> and <span class="math inline">\(s\)</span>, or parallelograms in a Lexis diagram
over <span class="math inline">\(t\)</span> and <span class="math inline">\(s\)</span>. The two time scales model is estimated
over the half-plane <span class="math inline">\((u,s)\)</span>.
Therefore, we will here discuss only preparation of the data over <span class="math inline">\(u\)</span> and <span class="math inline">\(s\)</span>, and defer the discussion of the
preparation over the Lexis diagram to the vignette dedicated to the
analysis with two time scales.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt2ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_data</a></span><span class="op">(</span>u <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">timer</span>,</span>
<span>                      s_in <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">entrys</span>,</span>
<span>                      s_out <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">timesr</span>,</span>
<span>                      events <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">status</span>,</span>
<span>                      ds <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dt2ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ bins   :List of 6</span></span>
<span><span class="co">#&gt;   ..$ bins_u: num [1:77] 8 38 68 98 128 158 188 218 248 278 ...</span></span>
<span><span class="co">#&gt;   ..$ midu  : num [1:76] 23 53 83 113 143 173 203 233 263 293 ...</span></span>
<span><span class="co">#&gt;   ..$ nu    : int 76</span></span>
<span><span class="co">#&gt;   ..$ bins_s: num [1:92] 0 30 60 90 120 150 180 210 240 270 ...</span></span>
<span><span class="co">#&gt;   ..$ mids  : num [1:91] 15 45 75 105 135 165 195 225 255 285 ...</span></span>
<span><span class="co">#&gt;   ..$ ns    : int 91</span></span>
<span><span class="co">#&gt;  $ bindata:List of 2</span></span>
<span><span class="co">#&gt;   ..$ R: num [1:76, 1:91] 115 218 450 696 474 701 460 686 462 457 ...</span></span>
<span><span class="co">#&gt;   ..$ Y: num [1:76, 1:91] 1 1 0 1 1 2 1 1 1 2 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "data2ts"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dt2ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class 'data2ts'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data:</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ bins   :List of 6</span></span>
<span><span class="co">#&gt;  $ bindata:List of 2</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "data2ts"</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Range covered by the bins: </span></span>
<span><span class="co">#&gt; $bins_u</span></span>
<span><span class="co">#&gt; [1]    8 2288</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bins_s</span></span>
<span><span class="co">#&gt; [1]    0 2730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of bins: </span></span>
<span><span class="co">#&gt; $nu</span></span>
<span><span class="co">#&gt; [1] 76</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ns</span></span>
<span><span class="co">#&gt; [1] 91</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overview of the binned data:</span></span>
<span><span class="co">#&gt; [1] "Total exposure time: 236006"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "Total number of events: 409"</span></span></code></pre></div>
<p>We have now included only one additional input <code>u</code>, that
is the vector with the individuals’ time at recurrence of the cancer.
The object <code>dt2ts</code> has the same structure as
<code>dt1ts</code>, but with additional bins over <span class="math inline">\(u\)</span> (<code>bins_u</code>, <code>midu</code>
and <code>nu</code>). The data are now matrices <code>R</code> and
<code>Y</code> of dimension <code>nu</code> by <code>ns</code>.</p>
</div>
<div class="section level4">
<h4 id="including-covariates">Including covariates<a class="anchor" aria-label="anchor" href="#including-covariates"></a>
</h4>
<p>If we want to estimate a proportional hazard model with covariates a
different structure of the data is required (see <span class="citation">Carollo et al. (2023)</span>). The data are augmented
by one dimension. So, for the model with one time scale only, we need to
create a matrix of exposure times <code>R</code> with dimension
<code>n</code> (number of individuals in the data) by <code>ns</code>
(number of bins). The same goes for the matrix of events’ count. For the
model with two time scales, each observation in the sample will be
represented by its own matrix of exposure times and matrix of events’
indicator. Therefore, the data for the whole sample can be arranged in
three-dimensional arrays, with dimensions <code>nu</code> by
<code>ns</code> by <code>n</code>. The function
<code><a href="../reference/prepare_data.html">prepare_data()</a></code> does exactly so by specifying the optional
input <code>individual = TRUE</code>. It is possible, and recommended,
to provide the covariates that one wishes to use in the PH model in the
extra argument <code>covs</code>. The function will take care of the
preparation of the regression matrix <code>Z</code>. However, if
desired, this can also be prepared externally (in which case a warning
will be returned).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">reccolon2ts</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rx"</span>, <span class="st">"node4"</span>, <span class="st">"sex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt2ts_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_data</a></span><span class="op">(</span>u <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">timer</span>,</span>
<span>                          s_in <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">entrys</span>,</span>
<span>                          s_out <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">timesr</span>,</span>
<span>                          events <span class="op">=</span> <span class="va">reccolon2ts</span><span class="op">$</span><span class="va">status</span>,</span>
<span>                          ds <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                          individual <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                          covs <span class="op">=</span> <span class="va">covs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dt2ts_cov</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ bins   :List of 6</span></span>
<span><span class="co">#&gt;   ..$ bins_u: num [1:77] 8 38 68 98 128 158 188 218 248 278 ...</span></span>
<span><span class="co">#&gt;   ..$ midu  : num [1:76] 23 53 83 113 143 173 203 233 263 293 ...</span></span>
<span><span class="co">#&gt;   ..$ nu    : int 76</span></span>
<span><span class="co">#&gt;   ..$ bins_s: num [1:92] 0 30 60 90 120 150 180 210 240 270 ...</span></span>
<span><span class="co">#&gt;   ..$ mids  : num [1:91] 15 45 75 105 135 165 195 225 255 285 ...</span></span>
<span><span class="co">#&gt;   ..$ ns    : int 91</span></span>
<span><span class="co">#&gt;  $ bindata:List of 3</span></span>
<span><span class="co">#&gt;   ..$ R: num [1:76, 1:91, 1:461] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ Y: num [1:76, 1:91, 1:461] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ Z: num [1:461, 1:4] 0 0 0 0 0 1 0 1 0 1 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:4] "Lev" "Lev+5FU" "node4" "male"</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "data2ts"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dt2ts_cov</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class 'data2ts'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data:</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ bins   :List of 6</span></span>
<span><span class="co">#&gt;  $ bindata:List of 3</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "data2ts"</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Range covered by the bins: </span></span>
<span><span class="co">#&gt; $bins_u</span></span>
<span><span class="co">#&gt; [1]    8 2288</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bins_s</span></span>
<span><span class="co">#&gt; [1]    0 2730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of bins: </span></span>
<span><span class="co">#&gt; $nu</span></span>
<span><span class="co">#&gt; [1] 76</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ns</span></span>
<span><span class="co">#&gt; [1] 91</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overview of the binned data:</span></span>
<span><span class="co">#&gt; [1] "Total exposure time: 236006"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "Total number of events: 409"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariates:</span></span>
<span><span class="co">#&gt; [1] "Lev"     "Lev+5FU" "node4"   "male"</span></span></code></pre></div>
<p>The data are now the three-dimensional arrays, <code>R</code> and
<code>Y</code> and a regression matrix <code>Z</code>, where the
covariates are transformed in dummy variables (where needed). The print
method returns also the names of the dummy variables, so we can see that
from the variable <code>rx</code> we obtained the two dummies
<code>Lev</code> and <code>Lev+5FU</code> and from the variable
<code>sex</code> we obtained now the dummy variable <code>male</code>
(<code>Obs</code> and <code>female</code> are reference categories, as
well as not having more than four nodes).</p>
</div>
</div>
<div class="section level3">
<h3 id="step-2-estimation">Step 2: Estimation<a class="anchor" aria-label="anchor" href="#step-2-estimation"></a>
</h3>
<div class="section level4">
<h4 id="one-time-scale">One time scale<a class="anchor" aria-label="anchor" href="#one-time-scale"></a>
</h4>
<p>To estimate the model we use the function <code><a href="../reference/fit1ts.html">fit1ts()</a></code>. As
input to this function we pass the object returned from
<code>prepare_data</code>. Without specifying additional parameters, the
function estimates a <span class="math inline">\(P\)</span>-splines
model, by using numerical optimization of the AIC to find the optimal
smoothing parameter. The <span class="math inline">\(B\)</span>-splines
basis is built using default options (see <code><a href="../reference/fit1ts.html">help(fit1ts)</a></code> for
details). However, for illustration, we now show how to specify the
<span class="math inline">\(B\)</span>-splines basis to more closely
match the data structure.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit1ts.html">fit1ts</a></span><span class="op">(</span>data1ts <span class="op">=</span> <span class="va">dt1ts</span>,</span>
<span>               Bbases_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bdeg <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                  nseg_s <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  min_s <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                  max_s <span class="op">=</span> <span class="fl">2730</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">m1ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ optimal_model :List of 9</span></span>
<span><span class="co">#&gt;   ..$ alpha   : num [1:23, 1] -6.69 -6.51 -6.34 -6.2 -6.14 ...</span></span>
<span><span class="co">#&gt;   ..$ SE_alpha: num [1:23] 0.2264 0.1228 0.0761 0.0741 0.0794 ...</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:91, 1] -6.5 -6.46 -6.42 -6.38 -6.35 ...</span></span>
<span><span class="co">#&gt;   ..$ H       : num [1:23, 1:23] 0.07393 0.04624 0.02013 0.00333 -0.00356 ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 79.5</span></span>
<span><span class="co">#&gt;   ..$ ed      : num 4.23</span></span>
<span><span class="co">#&gt;   ..$ aic     : num 88</span></span>
<span><span class="co">#&gt;   ..$ bic     : num 98.6</span></span>
<span><span class="co">#&gt;   ..$ Bbases  :List of 1</span></span>
<span><span class="co">#&gt;   .. ..$ Bs: num [1:91, 1:23] 1.18e-01 5.02e-02 1.52e-02 2.05e-03 2.21e-07 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "x")= num [1:91] 15 45 75 105 135 165 195 225 255 285 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "xl")= num 0</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "xr")= num 2730</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "nseg")= num 20</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "bdeg")= num 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "type")= chr "bbase"</span></span>
<span><span class="co">#&gt;  $ optimal_logrho: num 2.03</span></span>
<span><span class="co">#&gt;  $ P_optim       : num [1:23, 1:23] 108 -216 108 0 0 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "haz1ts"</span></span></code></pre></div>
<p>Here, we specify a cubic (<code>bdeg = 3</code>) <span class="math inline">\(B\)</span>-splines basis that covers the range of
<span class="math inline">\(s\)</span> from 0 to 2730 days
(<code>min_s</code> and <code>max_s</code> respectively), and is built
on 20 segments (<code>nseg_s = 20</code>). The object returned by
<code>fit1ts</code> is of class <code>"haz1ts"</code>. The first element
is a list with the results of the optimal model. The second element is
the optimal smoothing parameter (on the <span class="math inline">\(\log_{10}\)</span>-scale) and the last element is
the penalty matrix, which incorporates the optimal value of <span class="math inline">\(\varrho\)</span>, <code>P_optim</code>.</p>
<p>The vignette <em>Smooth hazards with one time scale</em> discusses
alternative options for estimation, in particular concerning the search
for the optimal smoothing parameter.</p>
</div>
<div class="section level4">
<h4 id="two-time-scales-1">Two time scales<a class="anchor" aria-label="anchor" href="#two-time-scales-1"></a>
</h4>
<p>Estimation over the half-plane <span class="math inline">\((u,s)\)</span> is performed in the same way. Here,
we illustrate how to use the function <code><a href="../reference/fit2ts.html">fit2ts()</a></code>, and again
we will change the default specifications of the marginal <span class="math inline">\(B\)</span>-spline bases, but otherwise use default
values for the remaining inputs.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit2ts.html">fit2ts</a></span><span class="op">(</span>data2ts <span class="op">=</span> <span class="va">dt2ts</span>,</span>
<span>               Bbases_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bdeg <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                  nseg_s <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  min_s <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                  max_s <span class="op">=</span> <span class="fl">2730</span>,</span>
<span>                                  nseg_u <span class="op">=</span> <span class="fl">16</span>,</span>
<span>                                  min_u <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                  max_u <span class="op">=</span> <span class="fl">2300</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">m2ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ optimal_model :List of 10</span></span>
<span><span class="co">#&gt;   ..$ Alpha    : num [1:19, 1:23] -5.25 -5.73 -6.21 -6.65 -7.05 ...</span></span>
<span><span class="co">#&gt;   ..$ Cov_Alpha: num [1:437, 1:437] 0.5243 0.3701 0.2331 0.1223 0.0395 ...</span></span>
<span><span class="co">#&gt;   ..$ deviance : num 1220</span></span>
<span><span class="co">#&gt;   ..$ Eta      : num [1:76, 1:91] -5.63 -5.72 -5.8 -5.89 -5.97 ...</span></span>
<span><span class="co">#&gt;   ..$ H        : num [1:76, 1:91] 0.0219 0.0319 0.0512 0.0624 0.0341 ...</span></span>
<span><span class="co">#&gt;   ..$ ed       : num 12.6</span></span>
<span><span class="co">#&gt;   ..$ aic      : num 1245</span></span>
<span><span class="co">#&gt;   ..$ bic      : num 1331</span></span>
<span><span class="co">#&gt;   ..$ Bbases   :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ Bu: num [1:76, 1:19] 9.88e-02 4.19e-02 1.26e-02 1.63e-03 2.37e-08 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "x")= num [1:76] 23 53 83 113 143 173 203 233 263 293 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "xl")= num 0</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "xr")= num 2300</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "nseg")= num 16</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "bdeg")= num 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "type")= chr "bbase"</span></span>
<span><span class="co">#&gt;   .. ..$ Bs: num [1:91, 1:23] 1.18e-01 5.02e-02 1.52e-02 2.05e-03 2.21e-07 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "x")= num [1:91] 15 45 75 105 135 165 195 225 255 285 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "xl")= num 0</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "xr")= num 2730</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "nseg")= num 20</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "bdeg")= num 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "type")= chr "bbase"</span></span>
<span><span class="co">#&gt;   ..$ nevents  : num 409</span></span>
<span><span class="co">#&gt;  $ optimal_logrho: num [1:2] 1.576 0.453</span></span>
<span><span class="co">#&gt;  $ P_optim       : num [1:437, 1:437] 40.5 -75.3 37.7 0 0 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "haz2ts"</span></span></code></pre></div>
<p>Whereas the estimates from <code>fit1ts</code> are vectors, the ones
from <code>fit2ts</code> are organized in matrices: The matrix
<code>optimal_model$Alpha</code>, containing the estimated <span class="math inline">\(B\)</span>-splines’ coefficients <span class="math inline">\(\alpha_{lm}\)</span>, for <span class="math inline">\(l \in 1,\dots,c_u\)</span> (here <span class="math inline">\(c_u = 19\)</span>) and <span class="math inline">\(m \in 1,\dots, c_s\)</span> (<span class="math inline">\(c_s = 23\)</span>). And the matrix Eta of
dimension <span class="math inline">\(n_u\)</span> by <span class="math inline">\(n_s\)</span> (90 by 91). Additionally, we have a
list with the marginal <span class="math inline">\(B\)</span>-splines
used for estimation (<code>optimal_model$Bbases</code>), a vector of
<span class="math inline">\(\log_{10}\varrho_u\)</span> and <span class="math inline">\(\log_{10}\varrho_s\)</span> values
(<code>optimal_logrho</code>) and finally the penalty matrix
(<code>P_optim</code>) that incorporates the optimal penalty
parameters.</p>
</div>
</div>
<div class="section level3">
<h3 id="step-3-visualize-the-results">Step 3: Visualize the results<a class="anchor" aria-label="anchor" href="#step-3-visualize-the-results"></a>
</h3>
<div class="section level4">
<h4 id="one-time-scale-1">One time scale<a class="anchor" aria-label="anchor" href="#one-time-scale-1"></a>
</h4>
<p>Once the model is estimated, we can represent the results with the
function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.The minimal input for <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
is the fitted model. Here, we show how to evaluate the <span class="math inline">\(B\)</span>-splines basis on a finer grid of
intervals that are only 10 days apart (as opposite to 30, option that
was used for the estimating <span class="math inline">\(B\)</span>-splines). Moreover, we pass as inputs
some graphical parameters to obtain a nicer plot. The result is a plot
of the one-dimensional hazard curve over <span class="math inline">\(s\)</span> (time since recurrence), with accompany
95% confidence bands.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">m1ts</span>,</span>
<span>     plot_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"smin"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"smax"</span> <span class="op">=</span> <span class="fl">2730</span>, <span class="st">"ds"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>     plot_options<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Hazard"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"hazard"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"time since recurrence"</span>,</span>
<span>       cex_main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="TwoTimeScales_files/figure-html/1ts-plot-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="two-time-scales-2">Two time scales<a class="anchor" aria-label="anchor" href="#two-time-scales-2"></a>
</h4>
<p>There are several options to represent the smooth hazard with two
time scales. Here, we will present only the most simple, yet very
informative, way, which is also the default plot returned by the
function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, applied to an object of class
<code>"haz2ts"</code>. This is a surface plot of the hazard over the
<span class="math inline">\((u,s)\)</span>-plane with white contour
lines. We provide a vignette that only focus on visualization of the
hazard with two time scales <em>Visualize hazards with two time
scales</em>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">m2ts</span>,</span>
<span>     plot_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"umin"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"umax"</span> <span class="op">=</span> <span class="fl">2300</span>, <span class="st">"du"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"smin"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"smax"</span> <span class="op">=</span> <span class="fl">2730</span>, <span class="st">"ds"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     plot_options<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       main <span class="op">=</span> <span class="st">"Bi-dimensional hazard"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"time since recurrence"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"time since randomization"</span>,</span>
<span>       cex_main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="TwoTimeScales_files/figure-html/2ts-plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Carollo:2023" class="csl-entry">
Carollo, Angela, Paul H. C. Eilers, Hein Putter, and Jutta Gampe. 2023.
<span>“Smooth Hazards with Multiple Time Scales.”</span> <em>arXiv
Preprint: arXiv:2305.09342</em>, May. <a href="https://arxiv.org/abs/http://arxiv.org/abs/2305.09342v1" class="external-link">https://arxiv.org/abs/http://arxiv.org/abs/2305.09342v1</a>.
</div>
<div id="ref-Laurie:1989" class="csl-entry">
Laurie, J. A., C. G. Moertel, T. R. Fleming, H. S. Wieand, J. E. Leigh,
J. Rubin, G. W. McCormack, J. B. Gerstner, J. E. Krook, and J. Malliard.
1989. <span>“<span class="nocase">Surgical adjuvant therapy of
large-bowel carcinoma: an evaluation of levamisole and the combination
of levamisole and fluorouracil. The North Central Cancer Treatment Group
and the Mayo Clinic.</span>”</span> <em>Journal of Clinical
Oncology</em> 7 (10): 1447–56. <a href="https://doi.org/10.1200/JCO.1989.7.10.1447" class="external-link">https://doi.org/10.1200/JCO.1989.7.10.1447</a>.
</div>
<div id="ref-Moertel:1995" class="csl-entry">
Moertel, Charles G., Thomas R. Fleming, John S. Macdonald, Daniel G.
Haller, John A. Laurie, Catherine M. Tangen, James S. Ungerleider, et
al. 1995. <span>“<span class="nocase">Fluorouracil plus
<span>L</span>evamisole as Effective Adjuvant Therapy after Resection of
Stage III Colon Carcinoma: A Final Report</span>.”</span> <em>Annals of
Internal Medicine</em> 122 (5): 321–26. <a href="https://doi.org/10.7326/0003-4819-122-5-199503010-00001" class="external-link">https://doi.org/10.7326/0003-4819-122-5-199503010-00001</a>.
</div>
<div id="ref-R:survival" class="csl-entry">
Therneau, Terry M. 2020. <em>A <span>P</span>ackage for
<span>S</span>urvival <span>A</span>nalysis in <span>R</span></em>. <a href="https://CRAN.R-project.org/package=survival" class="external-link">https://CRAN.R-project.org/package=survival</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Angela Carollo, Paul H.C. Eilers, Jutta Gampe.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
